<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Causal Inference" href="causal.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.05.06 -->
        <title>StochTree API - stochtree 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">stochtree 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">stochtree 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="supervised.html">Supervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="causal.html">Causal Inference</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">StochTree API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/api.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="stochtree-api">
<h1>StochTree API<a class="headerlink" href="#stochtree-api" title="Permalink to this heading">¶</a></h1>
<section id="bart">
<h2>BART<a class="headerlink" href="#bart" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stochtree.bart.BARTModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochtree.bart.</span></span><span class="sig-name descname"><span class="pre">BARTModel</span></span><a class="headerlink" href="#stochtree.bart.BARTModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that handles sampling, storage, and serialization of stochastic forest models like BART, XBART, and Warm-Start BART</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochtree.bart.BARTModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#stochtree.bart.BARTModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict outcome from every retained forest of a BART sampler.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>covariates<span class="classifier">np.array</span></dt><dd><p>Test set covariates.</p>
</dd>
<dt>basis_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set basis vector, must be provided if the model was trained with a leaf regression basis.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>np.array</dt><dd><p>Array of predictions with as many rows as in <code class="docutils literal notranslate"><span class="pre">covariates</span></code> and as many columns as retained samples of the algorithm.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochtree.bart.BARTModel.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpoint_grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_leaf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_leaf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_leaf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_leaf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct_var_sigma2_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_burnin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sigma_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sigma_leaf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_burnin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_gfr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stochtree.bart.BARTModel.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a BART sampler on provided training set. Predictions will be cached for the training set and (if provided) the test set. 
Does not require a leaf regression basis.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>X_train<span class="classifier">np.array</span></dt><dd><p>Training set covariates on which trees may be partitioned.</p>
</dd>
<dt>y_train<span class="classifier">np.array</span></dt><dd><p>Training set outcome.</p>
</dd>
<dt>basis_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional training set basis vector used to define a regression to be run in the leaves of each tree.</p>
</dd>
<dt>X_test<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set covariates.</p>
</dd>
<dt>basis_test<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set basis vector used to define a regression to be run in the leaves of each tree. 
Must be included / omitted consistently (i.e. if basis_train is provided, then basis_test must be provided alongside X_test).</p>
</dd>
<dt>cutpoint_grid_size<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Maximum number of cutpoints to consider for each feature. Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p>
</dd>
<dt>sigma_leaf<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Scale parameter on the leaf node regression model.</p>
</dd>
<dt>alpha<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Prior probability of splitting for a tree of depth 0. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>beta<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Exponent that decreases split probabilities for nodes of depth &gt; 0. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>min_samples_leaf<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Minimum allowable size of a leaf, in terms of training samples. Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
</dd>
<dt>max_depth<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Maximum depth of any tree in the ensemble. Defaults to <code class="docutils literal notranslate"><span class="pre">10</span></code>. Can be overriden with <code class="docutils literal notranslate"><span class="pre">-1</span></code> which does not enforce any depth limits on trees.</p>
</dd>
<dt>a_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Shape parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code> global error variance model. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt>b_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Component of the scale parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code> global error variance prior. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt>a_leaf<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Shape parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model. Defaults to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
</dd>
<dt>b_leaf<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Scale parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model. Calibrated internally as <code class="docutils literal notranslate"><span class="pre">0.5/num_trees</span></code> if not set here.</p>
</dd>
<dt>q<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Quantile used to calibrated <code class="docutils literal notranslate"><span class="pre">lamb</span></code> as in Sparapani et al (2021). Defaults to <code class="docutils literal notranslate"><span class="pre">0.9</span></code>.</p>
</dd>
<dt>sigma2<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Starting value of global variance parameter. Set internally as a percentage of the standardized outcome variance if not set here.</p>
</dd>
<dt>pct_var_sigma2_init<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Percentage of standardized outcome variance used to initialize global error variance parameter. Superseded by <code class="docutils literal notranslate"><span class="pre">sigma2</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">0.25</span></code>.</p>
</dd>
<dt>num_trees<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of trees in the ensemble. Defaults to <code class="docutils literal notranslate"><span class="pre">200</span></code>.</p>
</dd>
<dt>num_gfr<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “warm-start” iterations run using the grow-from-root algorithm (He and Hahn, 2021). Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
</dd>
<dt>num_burnin<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “burn-in” iterations of the MCMC sampler. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_gfr</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p>
</dd>
<dt>num_mcmc<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “retained” iterations of the MCMC sampler. Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>. If this is set to 0, GFR (XBART) samples will be retained.</p>
</dd>
<dt>sample_sigma_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to update the <code class="docutils literal notranslate"><span class="pre">sigma^2</span></code> global error variance parameter based on <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>sample_sigma_leaf<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to update the <code class="docutils literal notranslate"><span class="pre">tau</span></code> leaf scale variance parameter based on <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code>. Cannot (currently) be set to true if <code class="docutils literal notranslate"><span class="pre">basis_train</span></code> has more than one column. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>random_seed<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Integer parameterizing the C++ random number generator. If not specified, the C++ random number generator is seeded according to <code class="docutils literal notranslate"><span class="pre">std::random_device</span></code>.</p>
</dd>
<dt>keep_burnin<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not “burnin” samples should be included in predictions. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_mcmc</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
</dd>
<dt>keep_gfr<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not “warm-start” / grow-from-root samples should be included in predictions. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_mcmc</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>self<span class="classifier">BARTModel</span></dt><dd><p>Sampled BART Model.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="bcf">
<h2>BCF<a class="headerlink" href="#bcf" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stochtree.bcf.BCFModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochtree.bcf.</span></span><span class="sig-name descname"><span class="pre">BCFModel</span></span><a class="headerlink" href="#stochtree.bcf.BCFModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that handles sampling, storage, and serialization of causal BART models like BCF, XBCF, and Warm-Start BCF</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochtree.bcf.BCFModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#stochtree.bcf.BCFModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict outcome model components (CATE function and prognostic function) as well as overall outcome for every provided observation. 
Predicted outcomes are computed as <code class="docutils literal notranslate"><span class="pre">yhat</span> <span class="pre">=</span> <span class="pre">mu_x</span> <span class="pre">+</span> <span class="pre">Z*tau_x</span></code> where mu_x is a sample of the prognostic function and tau_x is a sample of the treatment effect (CATE) function.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>X<span class="classifier">np.array or pd.DataFrame</span></dt><dd><p>Test set covariates.</p>
</dd>
<dt>Z<span class="classifier">np.array</span></dt><dd><p>Test set treatment indicators.</p>
</dd>
<dt>propensity<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set propensities. Must be provided if propensities were provided when the model was sampled.</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>tuple of np.array</dt><dd><p>Tuple of arrays with as many rows as in <code class="docutils literal notranslate"><span class="pre">X</span></code> and as many columns as retained samples of the algorithm. 
The first entry of the tuple contains conditional average treatment effect (CATE) samples, 
the second entry contains prognostic effect samples, and the third entry contains outcome prediction samples</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochtree.bcf.BCFModel.predict_tau">
<span class="sig-name descname"><span class="pre">predict_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#stochtree.bcf.BCFModel.predict_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict CATE function for every provided observation.</p>
<section id="id5">
<h3>Parameters<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>X<span class="classifier">np.array or pd.DataFrame</span></dt><dd><p>Test set covariates.</p>
</dd>
<dt>Z<span class="classifier">np.array</span></dt><dd><p>Test set treatment indicators.</p>
</dd>
<dt>propensity<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set propensities. Must be provided if propensities were provided when the model was sampled.</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>np.array</dt><dd><p>Array with as many rows as in <code class="docutils literal notranslate"><span class="pre">X</span></code> and as many columns as retained samples of the algorithm.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochtree.bcf.BCFModel.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpoint_grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_leaf_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_leaf_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_leaf_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_leaf_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_leaf_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_leaf_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_leaf_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_leaf_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct_var_sigma2_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_vars_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_vars_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_vars_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_vars_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trees_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trees_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_burnin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sigma_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sigma_leaf_mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_sigma_leaf_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_covariate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_coding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_burnin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_gfr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stochtree.bcf.BCFModel.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a BCF sampler on provided training set. Outcome predictions and estimates of the prognostic and treatment effect functions 
will be cached for the training set and (if provided) the test set.</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>X_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pd.DataFrame</span></code></span></dt><dd><p>Covariates used to split trees in the ensemble. Can be passed as either a matrix or dataframe.</p>
</dd>
<dt>Z_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code></span></dt><dd><p>Array of (continuous or binary; univariate or multivariate) treatment assignments.</p>
</dd>
<dt>y_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code></span></dt><dd><p>Outcome to be modeled by the ensemble.</p>
</dd>
<dt>pi_train<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code></span></dt><dd><p>Optional vector of propensity scores. If not provided, this will be estimated from the data.</p>
</dd>
<dt>X_test<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set of covariates used to define “out of sample” evaluation data.</p>
</dd>
<dt>Z_test<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set of (continuous or binary) treatment assignments.
Must be provided if <code class="docutils literal notranslate"><span class="pre">X_test</span></code> is provided.</p>
</dd>
<dt>pi_test<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Optional test set vector of propensity scores. If not provided (but <code class="docutils literal notranslate"><span class="pre">X_test</span></code> and <code class="docutils literal notranslate"><span class="pre">Z_test</span></code> are), this will be estimated from the data.</p>
</dd>
<dt>cutpoint_grid_size<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Maximum number of cutpoints to consider for each feature. Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p>
</dd>
<dt>sigma_leaf_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Starting value of leaf node scale parameter for the prognostic forest. Calibrated internally as <code class="docutils literal notranslate"><span class="pre">2/num_trees_mu</span></code> if not set here.</p>
</dd>
<dt>sigma_leaf_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Starting value of leaf node scale parameter for the treatment effect forest. 
When treatment (<code class="docutils literal notranslate"><span class="pre">Z_train</span></code>) is multivariate, this can be either a <code class="docutils literal notranslate"><span class="pre">float</span></code> or a square 2-dimensional <code class="docutils literal notranslate"><span class="pre">np.array</span></code> 
with <code class="docutils literal notranslate"><span class="pre">sigma_leaf_tau.shape[0]</span> <span class="pre">==</span> <span class="pre">Z_train.shape[1]</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma_leaf_tau.shape[1]</span> <span class="pre">==</span> <span class="pre">Z_train.shape[1]</span></code>.
If <code class="docutils literal notranslate"><span class="pre">sigma_leaf_tau</span></code> is provided as a float for multivariate treatment, the leaf scale term will be set as a 
diagonal matrix with <code class="docutils literal notranslate"><span class="pre">sigma_leaf_tau</span></code> on every diagonal. If not passed as an argument, this parameter is 
calibrated internally as <code class="docutils literal notranslate"><span class="pre">1/num_trees_tau</span></code> (and propagated to a diagonal matrix if necessary).</p>
</dd>
<dt>alpha_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Prior probability of splitting for a tree of depth 0 for the prognostic forest. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>alpha_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Prior probability of splitting for a tree of depth 0 for the treatment effect forest. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>beta_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Exponent that decreases split probabilities for nodes of depth &gt; 0 for the prognostic forest. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>beta_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Exponent that decreases split probabilities for nodes of depth &gt; 0 for the treatment effect forest. 
Tree split prior combines <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> via <code class="docutils literal notranslate"><span class="pre">alpha*(1+node_depth)^-beta</span></code>.</p>
</dd>
<dt>min_samples_leaf_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Minimum allowable size of a leaf, in terms of training samples, for the prognostic forest. Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
</dd>
<dt>min_samples_leaf_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Minimum allowable size of a leaf, in terms of training samples, for the treatment effect forest. Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
</dd>
<dt>max_depth_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Maximum depth of any tree in the mu ensemble. Defaults to <code class="docutils literal notranslate"><span class="pre">10</span></code>. Can be overriden with <code class="docutils literal notranslate"><span class="pre">-1</span></code> which does not enforce any depth limits on trees.</p>
</dd>
<dt>max_depth_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Maximum depth of any tree in the tau ensemble. Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>. Can be overriden with <code class="docutils literal notranslate"><span class="pre">-1</span></code> which does not enforce any depth limits on trees.</p>
</dd>
<dt>a_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Shape parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code> global error variance model. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt>b_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Component of the scale parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code> global error variance prior. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt>a_leaf_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Shape parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model for the prognostic forest. Defaults to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
</dd>
<dt>a_leaf_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Shape parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model for the treatment effect forest. Defaults to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
</dd>
<dt>b_leaf_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Scale parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model for the prognostic forest. Calibrated internally as <code class="docutils literal notranslate"><span class="pre">0.5/num_trees</span></code> if not set here.</p>
</dd>
<dt>b_leaf_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Scale parameter in the <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> leaf node parameter variance model for the treatment effect forest. Calibrated internally as <code class="docutils literal notranslate"><span class="pre">0.5/num_trees</span></code> if not set here.</p>
</dd>
<dt>q<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Quantile used to calibrated <code class="docutils literal notranslate"><span class="pre">lamb</span></code> as in Sparapani et al (2021). Defaults to <code class="docutils literal notranslate"><span class="pre">0.9</span></code>.</p>
</dd>
<dt>sigma2<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Starting value of global variance parameter. Calibrated internally as in Sparapani et al (2021) if not set here.</p>
</dd>
<dt>pct_var_sigma2_init<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Percentage of standardized outcome variance used to initialize global error variance parameter. Superseded by <code class="docutils literal notranslate"><span class="pre">sigma2</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">0.25</span></code>.</p>
</dd>
<dt>variable_weights<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Numeric weights reflecting the relative probability of splitting on each variable. Does not need to sum to 1 but cannot be negative. Defaults to <code class="docutils literal notranslate"><span class="pre">np.repeat(1/X_train.shape[1],</span> <span class="pre">X_train.shape[1])</span></code> if not set here. Note that if the propensity score is included as a covariate in either forest, its weight will default to <code class="docutils literal notranslate"><span class="pre">1/X_train.shape[1]</span></code>. A workaround if you wish to provide a custom weight for the propensity score is to include it as a column in <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and then set <code class="docutils literal notranslate"><span class="pre">propensity_covariate</span></code> to <code class="docutils literal notranslate"><span class="pre">'none'</span></code> and adjust <code class="docutils literal notranslate"><span class="pre">keep_vars_mu</span></code> and <code class="docutils literal notranslate"><span class="pre">keep_vars_tau</span></code> accordingly.</p>
</dd>
<dt>keep_vars_mu<span class="classifier">obj:<cite>list</cite> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Vector of variable names or column indices denoting variables that should be included in the prognostic (<code class="docutils literal notranslate"><span class="pre">mu(X)</span></code>) forest. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>drop_vars_mu<span class="classifier">obj:<cite>list</cite> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Vector of variable names or column indices denoting variables that should be excluded from the prognostic (<code class="docutils literal notranslate"><span class="pre">mu(X)</span></code>) forest. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. If both <code class="docutils literal notranslate"><span class="pre">drop_vars_mu</span></code> and <code class="docutils literal notranslate"><span class="pre">keep_vars_mu</span></code> are set, <code class="docutils literal notranslate"><span class="pre">drop_vars_mu</span></code> will be ignored.</p>
</dd>
<dt>keep_vars_tau<span class="classifier">obj:<cite>list</cite> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Vector of variable names or column indices denoting variables that should be included in the treatment effect (<code class="docutils literal notranslate"><span class="pre">tau(X)</span></code>) forest. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>drop_vars_tau<span class="classifier">obj:<cite>list</cite> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>, optional</span></dt><dd><p>Vector of variable names or column indices denoting variables that should be excluded from the treatment effect (<code class="docutils literal notranslate"><span class="pre">tau(X)</span></code>) forest. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. If both <code class="docutils literal notranslate"><span class="pre">drop_vars_tau</span></code> and <code class="docutils literal notranslate"><span class="pre">keep_vars_tau</span></code> are set, <code class="docutils literal notranslate"><span class="pre">drop_vars_tau</span></code> will be ignored.</p>
</dd>
<dt>num_trees_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of trees in the prognostic forest. Defaults to <code class="docutils literal notranslate"><span class="pre">200</span></code>.</p>
</dd>
<dt>num_trees_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of trees in the treatment effect forest. Defaults to <code class="docutils literal notranslate"><span class="pre">50</span></code>.</p>
</dd>
<dt>num_gfr<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “warm-start” iterations run using the grow-from-root algorithm (He and Hahn, 2021). Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
</dd>
<dt>num_burnin<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “burn-in” iterations of the MCMC sampler. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_gfr</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p>
</dd>
<dt>num_mcmc<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Number of “retained” iterations of the MCMC sampler. Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>. If this is set to 0, GFR (XBART) samples will be retained.</p>
</dd>
<dt>sample_sigma_global<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to update the <code class="docutils literal notranslate"><span class="pre">sigma^2</span></code> global error variance parameter based on <code class="docutils literal notranslate"><span class="pre">IG(a_global,</span> <span class="pre">b_global)</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>sample_sigma_leaf_mu<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to update the <code class="docutils literal notranslate"><span class="pre">tau</span></code> leaf scale variance parameter based on <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> for the prognostic forest. 
Cannot (currently) be set to true if <code class="docutils literal notranslate"><span class="pre">basis_train</span></code> has more than one column. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>sample_sigma_leaf_tau<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to update the <code class="docutils literal notranslate"><span class="pre">tau</span></code> leaf scale variance parameter based on <code class="docutils literal notranslate"><span class="pre">IG(a_leaf,</span> <span class="pre">b_leaf)</span></code> for the treatment effect forest. 
Cannot (currently) be set to true if <code class="docutils literal notranslate"><span class="pre">basis_train</span></code> has more than one column. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>propensity_covariate<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional</span></dt><dd><p>Whether to include the propensity score as a covariate in either or both of the forests. Enter <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> for neither, <code class="docutils literal notranslate"><span class="pre">&quot;mu&quot;</span></code> for the prognostic forest, <code class="docutils literal notranslate"><span class="pre">&quot;tau&quot;</span></code> for the treatment forest, and <code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> for both forests. 
If this is not <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> and a propensity score is not provided, it will be estimated from (<code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">Z_train</span></code>) using <code class="docutils literal notranslate"><span class="pre">BARTModel</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mu&quot;</span></code>.</p>
</dd>
<dt>adaptive_coding<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not to use an “adaptive coding” scheme in which a binary treatment variable is not coded manually as (0,1) or (-1,1) but learned via 
parameters <code class="docutils literal notranslate"><span class="pre">b_0</span></code> and <code class="docutils literal notranslate"><span class="pre">b_1</span></code> that attach to the outcome model <code class="docutils literal notranslate"><span class="pre">[b_0</span> <span class="pre">(1-Z)</span> <span class="pre">+</span> <span class="pre">b_1</span> <span class="pre">Z]</span> <span class="pre">tau(X)</span></code>. This is ignored when Z is not binary. Defaults to True.</p>
</dd>
<dt>b_0<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Initial value of the “control” group coding parameter. This is ignored when <code class="docutils literal notranslate"><span class="pre">Z</span></code> is not binary. Default: <code class="docutils literal notranslate"><span class="pre">-0.5</span></code>.</p>
</dd>
<dt>b_1<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional</span></dt><dd><p>Initial value of the “treated” group coding parameter. This is ignored when <code class="docutils literal notranslate"><span class="pre">Z</span></code> is not binary. Default: <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p>
</dd>
<dt>random_seed<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional</span></dt><dd><p>Integer parameterizing the C++ random number generator. If not specified, the C++ random number generator is seeded according to <code class="docutils literal notranslate"><span class="pre">std::random_device</span></code>.</p>
</dd>
<dt>keep_burnin<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not “burnin” samples should be included in predictions. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_mcmc</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
</dd>
<dt>keep_gfr<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional</span></dt><dd><p>Whether or not “warm-start” / grow-from-root samples should be included in predictions. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Ignored if <code class="docutils literal notranslate"><span class="pre">num_mcmc</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>self<span class="classifier">BCFModel</span></dt><dd><p>Sampled BCF Model.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="causal.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Causal Inference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Drew Herren
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">StochTree API</a><ul>
<li><a class="reference internal" href="#bart">BART</a><ul>
<li><a class="reference internal" href="#stochtree.bart.BARTModel"><code class="docutils literal notranslate"><span class="pre">BARTModel</span></code></a><ul>
<li><a class="reference internal" href="#stochtree.bart.BARTModel.predict"><code class="docutils literal notranslate"><span class="pre">BARTModel.predict()</span></code></a></li>
<li><a class="reference internal" href="#stochtree.bart.BARTModel.sample"><code class="docutils literal notranslate"><span class="pre">BARTModel.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#bcf">BCF</a><ul>
<li><a class="reference internal" href="#stochtree.bcf.BCFModel"><code class="docutils literal notranslate"><span class="pre">BCFModel</span></code></a><ul>
<li><a class="reference internal" href="#stochtree.bcf.BCFModel.predict"><code class="docutils literal notranslate"><span class="pre">BCFModel.predict()</span></code></a></li>
<li><a class="reference internal" href="#stochtree.bcf.BCFModel.predict_tau"><code class="docutils literal notranslate"><span class="pre">BCFModel.predict_tau()</span></code></a></li>
<li><a class="reference internal" href="#stochtree.bcf.BCFModel.sample"><code class="docutils literal notranslate"><span class="pre">BCFModel.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f6245a2f"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>